[workspace]

[workspace.dependencies]
bytes = { version = "1", features = ["serde"] }
serde = { version = "1.0.228", features = ["derive"] }
serde_json = { version = "1.0.149" }
tokio = { version = "1.49.0", features = [
    "rt",
    "rt-multi-thread",
    "macros",
    "sync",
    "process",
    "fs",
    "time",
    "io-util",
] }
thiserror = "2.0.18"
anyhow = "1.0"

[workspace.lints.clippy]
collapsible_if = "allow"

[package]
name = "kreuzberg-r"
version = "4.3.8"
edition = "2024"
rust-version = "1.91"
authors = ["Na'aman Hirschfeld <nhirschfeld@gmail.com>"]
license = "MIT"
repository = "https://github.com/kreuzberg-dev/kreuzberg"
homepage = "https://kreuzberg.dev"
description = "R bindings (extendr) for Kreuzberg - high-performance document intelligence framework"

[lints]
workspace = true

[lib]
name = "kreuzberg_r"
crate-type = ["staticlib", "lib"]

[features]
default = []

[dependencies]
kreuzberg = { path = "../../vendor/kreuzberg", default-features = false, features = [
    "pdf",
    "office",
    "mdx",
    "email",
    "html",
    "xml",
    "archives",
    "language-detection",
    "chunking",
    "quality",
    "keywords",
] }
extendr-api = { version = "0.8", features = ["result_condition"] }
serde_json = { workspace = true }

# Non-wasm: full features including tokio runtime, OCR, embeddings, API server
[target.'cfg(not(target_arch = "wasm32"))'.dependencies]
kreuzberg = { path = "../../vendor/kreuzberg", features = [
    "excel",
    "ocr",
    "paddle-ocr",
    "embeddings",
    "api",
    "mcp",
    "otel",
    "bundled-pdfium",
    "tokio-runtime",
] }
tokio = { workspace = true }

# Wasm: lightweight excel without tokio dependency
[target.'cfg(target_arch = "wasm32")'.dependencies]
kreuzberg = { path = "../../vendor/kreuzberg", features = ["excel-wasm"] }

[dev-dependencies]
pretty_assertions = "1.4"
