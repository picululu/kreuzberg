/* Code generated by kreuzberg-e2e-generator. DO NOT EDIT. */
/* Category: smoke */

#include "helpers.h"
#include <stdio.h>

static void test_smoke_smoke_docx_basic(void) {
    CExtractionResult *result = run_extraction("docx/fake.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    assert_content_contains_any(result, (const char *[]){"Lorem", "ipsum", "document", "text"}, 4);
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_html_basic(void) {
    CExtractionResult *result = run_extraction("html/simple_table.html", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/html"}, 1);
    assert_min_content_length(result, 10);
    assert_content_contains_any(result, (const char *[]){"#", "**", "simple", "HTML"}, 4);
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_image_png(void) {
    CExtractionResult *result = run_extraction("images/sample.png", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"image/png"}, 1);
    /* metadata assertion: format */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "format"); (void)str_contains_ci(result->metadata_json, "\"PNG\""); }
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_json_basic(void) {
    CExtractionResult *result = run_extraction("json/simple.json", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/json"}, 1);
    assert_min_content_length(result, 5);
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_pdf_basic(void) {
    CExtractionResult *result = run_extraction("pdf/fake_memo.pdf", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/pdf"}, 1);
    assert_min_content_length(result, 50);
    assert_content_contains_any(result, (const char *[]){"May 5, 2023", "To Whom it May Concern"}, 2);
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_txt_basic(void) {
    CExtractionResult *result = run_extraction("text/report.txt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/plain"}, 1);
    assert_min_content_length(result, 5);
    kreuzberg_free_result(result);
}

static void test_smoke_smoke_xlsx_basic(void) {
    CExtractionResult *result = run_extraction("xlsx/stanley_cups.xlsx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}, 1);
    assert_min_content_length(result, 100);
    assert_content_contains_all(result, (const char *[]){"Team", "Location", "Stanley Cups", "Blues", "Flyers", "Maple Leafs", "STL", "PHI", "TOR"}, 9);
    assert_table_count(result, 1, 1, 0, 0);
    /* metadata assertion: sheet_count */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "sheet_count"); (void)str_contains_ci(result->metadata_json, "{\"gte\":2}"); }
    /* metadata assertion: sheet_names */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "sheet_names"); (void)str_contains_ci(result->metadata_json, "{\"contains\":[\"Stanley Cups\"]}"); }
    kreuzberg_free_result(result);
}

int main(void) {
    test_smoke_smoke_docx_basic();
    test_smoke_smoke_html_basic();
    test_smoke_smoke_image_png();
    test_smoke_smoke_json_basic();
    test_smoke_smoke_pdf_basic();
    test_smoke_smoke_txt_basic();
    test_smoke_smoke_xlsx_basic();
    printf("test_smoke: all tests passed\n");
    return 0;
}
