/* Code generated by kreuzberg-e2e-generator. DO NOT EDIT. */
/* Category: office */

#include "helpers.h"
#include <stdio.h>

static void test_office_office_bibtex_basic(void) {
    CExtractionResult *result = run_extraction("bibtex/comprehensive.bib", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-bibtex", "text/x-bibtex"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_djot_basic(void) {
    CExtractionResult *result = run_extraction("markdown/tables.djot", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/x-djot", "text/djot"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_doc_legacy(void) {
    if (skip_if_feature_unavailable("office")) return;
    CExtractionResult *result = run_extraction("doc/unit_test_lists.doc", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/msword"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docbook_basic(void) {
    CExtractionResult *result = run_extraction("docbook/docbook-reader.docbook", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/docbook+xml", "text/docbook"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_basic(void) {
    CExtractionResult *result = run_extraction("docx/sample_document.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_equations(void) {
    CExtractionResult *result = run_extraction("docx/equations.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_fake(void) {
    CExtractionResult *result = run_extraction("docx/fake.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_formatting(void) {
    CExtractionResult *result = run_extraction("docx/unit_test_formatting.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_headers(void) {
    CExtractionResult *result = run_extraction("docx/unit_test_headers.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_lists(void) {
    CExtractionResult *result = run_extraction("docx/unit_test_lists.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_docx_tables(void) {
    CExtractionResult *result = run_extraction("docx/docx_tables.docx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}, 1);
    assert_min_content_length(result, 50);
    assert_content_contains_all(result, (const char *[]){"Simple uniform table", "Nested Table", "merged cells", "Header Col"}, 4);
    assert_table_count(result, 1, 1, 0, 0);
    kreuzberg_free_result(result);
}

static void test_office_office_epub_basic(void) {
    CExtractionResult *result = run_extraction("epub/features.epub", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/epub+zip"}, 1);
    assert_min_content_length(result, 50);
    kreuzberg_free_result(result);
}

static void test_office_office_fb2_basic(void) {
    CExtractionResult *result = run_extraction("fictionbook/basic.fb2", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-fictionbook+xml"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_fictionbook_basic(void) {
    CExtractionResult *result = run_extraction("fictionbook/basic.fb2", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-fictionbook+xml", "application/x-fictionbook"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_jats_basic(void) {
    CExtractionResult *result = run_extraction("jats/sample_article.jats", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-jats+xml", "text/jats"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_jupyter_basic(void) {
    CExtractionResult *result = run_extraction("jupyter/rank.ipynb", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-ipynb+json"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_latex_basic(void) {
    CExtractionResult *result = run_extraction("latex/basic_sections.tex", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-latex", "text/x-latex"}, 2);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_markdown_basic(void) {
    CExtractionResult *result = run_extraction("markdown/comprehensive.md", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/markdown"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_mdx_basic(void) {
    CExtractionResult *result = run_extraction("markdown/sample.mdx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/mdx", "text/x-mdx"}, 2);
    assert_min_content_length(result, 50);
    kreuzberg_free_result(result);
}

static void test_office_office_mdx_getting_started(void) {
    CExtractionResult *result = run_extraction("markdown/mdx_getting_started.mdx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/mdx", "text/x-mdx"}, 2);
    assert_min_content_length(result, 2000);
    kreuzberg_free_result(result);
}

static void test_office_office_mdx_troubleshooting(void) {
    CExtractionResult *result = run_extraction("markdown/mdx_troubleshooting.mdx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/mdx", "text/x-mdx"}, 2);
    assert_min_content_length(result, 2000);
    kreuzberg_free_result(result);
}

static void test_office_office_mdx_using_mdx(void) {
    CExtractionResult *result = run_extraction("markdown/mdx_using_mdx.mdx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/mdx", "text/x-mdx"}, 2);
    assert_min_content_length(result, 2000);
    kreuzberg_free_result(result);
}

static void test_office_office_ods_basic(void) {
    CExtractionResult *result = run_extraction("data_formats/test_01.ods", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.oasis.opendocument.spreadsheet"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_odt_bold(void) {
    CExtractionResult *result = run_extraction("odt/bold.odt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.oasis.opendocument.text"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_odt_list(void) {
    CExtractionResult *result = run_extraction("odt/unorderedList.odt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.oasis.opendocument.text"}, 1);
    assert_min_content_length(result, 30);
    assert_content_contains_any(result, (const char *[]){"list item", "New level", "Pushed us"}, 3);
    kreuzberg_free_result(result);
}

static void test_office_office_odt_simple(void) {
    CExtractionResult *result = run_extraction("odt/simple.odt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.oasis.opendocument.text"}, 1);
    assert_min_content_length(result, 50);
    assert_content_contains_any(result, (const char *[]){"favorite things", "Parrots", "Analysis"}, 3);
    kreuzberg_free_result(result);
}

static void test_office_office_odt_table(void) {
    CExtractionResult *result = run_extraction("odt/table.odt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.oasis.opendocument.text"}, 1);
    assert_min_content_length(result, 10);
    assert_table_count(result, 1, 1, 0, 0);
    kreuzberg_free_result(result);
}

static void test_office_office_opml_basic(void) {
    CExtractionResult *result = run_extraction("opml/outline.opml", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/xml+opml", "text/x-opml", "application/x-opml+xml"}, 3);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_org_basic(void) {
    CExtractionResult *result = run_extraction("org/comprehensive.org", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/x-org", "text/org"}, 2);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_ppsx_slideshow(void) {
    CExtractionResult *result = run_extraction("pptx/sample.ppsx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.presentationml.slideshow"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_ppt_legacy(void) {
    if (skip_if_feature_unavailable("office")) return;
    CExtractionResult *result = run_extraction("ppt/simple.ppt", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.ms-powerpoint"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_pptx_basic(void) {
    CExtractionResult *result = run_extraction("pptx/simple.pptx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.presentationml.presentation"}, 1);
    assert_min_content_length(result, 50);
    kreuzberg_free_result(result);
}

static void test_office_office_pptx_images(void) {
    CExtractionResult *result = run_extraction("pptx/powerpoint_with_image.pptx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.presentationml.presentation"}, 1);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_pptx_pitch_deck(void) {
    CExtractionResult *result = run_extraction("pptx/pitch_deck_presentation.pptx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.presentationml.presentation"}, 1);
    assert_min_content_length(result, 100);
    kreuzberg_free_result(result);
}

static void test_office_office_rst_basic(void) {
    CExtractionResult *result = run_extraction("rst/restructured_text.rst", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"text/x-rst", "text/prs.fallenstein.rst"}, 2);
    assert_min_content_length(result, 20);
    kreuzberg_free_result(result);
}

static void test_office_office_rtf_basic(void) {
    CExtractionResult *result = run_extraction("rtf/extraction_test.rtf", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/rtf", "text/rtf"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_typst_basic(void) {
    CExtractionResult *result = run_extraction("typst/headings.typ", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/x-typst", "text/x-typst"}, 2);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_xls_legacy(void) {
    CExtractionResult *result = run_extraction("xls/test_excel.xls", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.ms-excel"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

static void test_office_office_xlsx_basic(void) {
    CExtractionResult *result = run_extraction("xlsx/stanley_cups.xlsx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}, 1);
    assert_min_content_length(result, 100);
    assert_content_contains_all(result, (const char *[]){"Team", "Location", "Stanley Cups"}, 3);
    assert_table_count(result, 1, 1, 0, 0);
    /* metadata assertion: sheet_count */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "sheet_count"); (void)str_contains_ci(result->metadata_json, "{\"gte\":2}"); }
    /* metadata assertion: sheet_names */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "sheet_names"); (void)str_contains_ci(result->metadata_json, "{\"contains\":[\"Stanley Cups\"]}"); }
    kreuzberg_free_result(result);
}

static void test_office_office_xlsx_multi_sheet(void) {
    CExtractionResult *result = run_extraction("xlsx/excel_multi_sheet.xlsx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}, 1);
    assert_min_content_length(result, 20);
    /* metadata assertion: sheet_count */
    if (result->metadata_json) { (void)str_contains_ci(result->metadata_json, "sheet_count"); (void)str_contains_ci(result->metadata_json, "{\"gte\":2}"); }
    kreuzberg_free_result(result);
}

static void test_office_office_xlsx_office_example(void) {
    CExtractionResult *result = run_extraction("xlsx/test_01.xlsx", NULL);
    if (!result) return; /* skipped */
    assert_expected_mime(result, (const char *[]){"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}, 1);
    assert_min_content_length(result, 10);
    kreuzberg_free_result(result);
}

int main(void) {
    test_office_office_bibtex_basic();
    test_office_office_djot_basic();
    test_office_office_doc_legacy();
    test_office_office_docbook_basic();
    test_office_office_docx_basic();
    test_office_office_docx_equations();
    test_office_office_docx_fake();
    test_office_office_docx_formatting();
    test_office_office_docx_headers();
    test_office_office_docx_lists();
    test_office_office_docx_tables();
    test_office_office_epub_basic();
    test_office_office_fb2_basic();
    test_office_office_fictionbook_basic();
    test_office_office_jats_basic();
    test_office_office_jupyter_basic();
    test_office_office_latex_basic();
    test_office_office_markdown_basic();
    test_office_office_mdx_basic();
    test_office_office_mdx_getting_started();
    test_office_office_mdx_troubleshooting();
    test_office_office_mdx_using_mdx();
    test_office_office_ods_basic();
    test_office_office_odt_bold();
    test_office_office_odt_list();
    test_office_office_odt_simple();
    test_office_office_odt_table();
    test_office_office_opml_basic();
    test_office_office_org_basic();
    test_office_office_ppsx_slideshow();
    test_office_office_ppt_legacy();
    test_office_office_pptx_basic();
    test_office_office_pptx_images();
    test_office_office_pptx_pitch_deck();
    test_office_office_rst_basic();
    test_office_office_rtf_basic();
    test_office_office_typst_basic();
    test_office_office_xls_legacy();
    test_office_office_xlsx_basic();
    test_office_office_xlsx_multi_sheet();
    test_office_office_xlsx_office_example();
    printf("test_office: all tests passed\n");
    return 0;
}
