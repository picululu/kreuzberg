# frozen_string_literal: true

# Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
# To regenerate: cargo run -p kreuzberg-e2e-generator -- generate --lang ruby
#
# Tests for token_reduction fixtures.

require_relative 'spec_helper'

RSpec.describe 'token_reduction fixtures' do
  it 'token_reduction_aggressive' do
    E2ERuby.run_fixture(
      'token_reduction_aggressive',
      'pdf/fake_memo.pdf',
      { token_reduction: { mode: 'aggressive' } },
      requirements: [],
      notes: nil,
      skip_if_missing: true
    ) do |result|
      E2ERuby::Assertions.assert_expected_mime(
        result,
        ['application/pdf']
      )
      E2ERuby::Assertions.assert_min_content_length(result, 5)
      E2ERuby::Assertions.assert_content_not_empty(result)
    end
  end

  it 'token_reduction_basic' do
    E2ERuby.run_fixture(
      'token_reduction_basic',
      'pdf/fake_memo.pdf',
      { token_reduction: { mode: 'moderate' } },
      requirements: [],
      notes: nil,
      skip_if_missing: true
    ) do |result|
      E2ERuby::Assertions.assert_expected_mime(
        result,
        ['application/pdf']
      )
      E2ERuby::Assertions.assert_min_content_length(result, 5)
      E2ERuby::Assertions.assert_content_not_empty(result)
    end
  end

  it 'token_reduction_light' do
    E2ERuby.run_fixture(
      'token_reduction_light',
      'pdf/fake_memo.pdf',
      { token_reduction: { mode: 'light' } },
      requirements: [],
      notes: nil,
      skip_if_missing: true
    ) do |result|
      E2ERuby::Assertions.assert_expected_mime(
        result,
        ['application/pdf']
      )
      E2ERuby::Assertions.assert_min_content_length(result, 10)
      E2ERuby::Assertions.assert_content_not_empty(result)
    end
  end

  it 'token_reduction_with_chunking' do
    E2ERuby.run_fixture(
      'token_reduction_with_chunking',
      'pdf/fake_memo.pdf',
      { chunking: { max_chars: 500, max_overlap: 50 }, token_reduction: { mode: 'moderate' } },
      requirements: [],
      notes: nil,
      skip_if_missing: true
    ) do |result|
      E2ERuby::Assertions.assert_expected_mime(
        result,
        ['application/pdf']
      )
      E2ERuby::Assertions.assert_min_content_length(result, 5)
      E2ERuby::Assertions.assert_chunks(result, min_count: 1, each_has_content: true)
      E2ERuby::Assertions.assert_content_not_empty(result)
    end
  end
end
