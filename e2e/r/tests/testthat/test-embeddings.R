# Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
# To regenerate: cargo run -p kreuzberg-e2e-generator -- generate --lang r
#
# Tests for embeddings fixtures.
# nolint start

test_that("embedding_async", {
  skip_if_feature_unavailable("embeddings")
  result <- run_fixture_with_method(
    "embedding_async",
    "pdf/fake_memo.pdf",
    list(chunking = list(embedding = list(model = list(name = "balanced", type = "preset"), normalize = TRUE), max_chars = 500L, max_overlap = 50L)),
    "async",
    "file",
    requirements = c("embeddings"),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/pdf"))
  assert_min_content_length(result, 10L)
  assert_chunks(result, min_count = 1L, each_has_content = TRUE, each_has_embedding = TRUE)
})

test_that("embedding_balanced_preset", {
  skip_if_feature_unavailable("embeddings")
  result <- run_fixture(
    "embedding_balanced_preset",
    "pdf/fake_memo.pdf",
    list(chunking = list(embedding = list(model = list(name = "balanced", type = "preset"), normalize = TRUE), max_chars = 500L, max_overlap = 50L)),
    requirements = c("embeddings"),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/pdf"))
  assert_min_content_length(result, 10L)
  assert_chunks(result, min_count = 1L, each_has_content = TRUE, each_has_embedding = TRUE)
})

test_that("embedding_disabled", {
  result <- run_fixture(
    "embedding_disabled",
    "pdf/fake_memo.pdf",
    list(chunking = list(max_chars = 500L, max_overlap = 50L)),
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/pdf"))
  assert_min_content_length(result, 10L)
  assert_chunks(result, min_count = 1L, each_has_content = TRUE, each_has_embedding = FALSE)
})

test_that("embedding_fast_preset", {
  skip_if_feature_unavailable("embeddings")
  result <- run_fixture(
    "embedding_fast_preset",
    "pdf/fake_memo.pdf",
    list(chunking = list(embedding = list(model = list(name = "fast", type = "preset"), normalize = TRUE), max_chars = 500L, max_overlap = 50L)),
    requirements = c("embeddings"),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/pdf"))
  assert_min_content_length(result, 10L)
  assert_chunks(result, min_count = 1L, each_has_content = TRUE, each_has_embedding = TRUE)
})
# nolint end
