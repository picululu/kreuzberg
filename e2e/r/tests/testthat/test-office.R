# Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
# To regenerate: cargo run -p kreuzberg-e2e-generator -- generate --lang r
#
# Tests for office fixtures.
# nolint start

test_that("office_bibtex_basic", {
  result <- run_fixture(
    "office_bibtex_basic",
    "bibtex/comprehensive.bib",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-bibtex", "text/x-bibtex"))
  assert_min_content_length(result, 10L)
})

test_that("office_djot_basic", {
  result <- run_fixture(
    "office_djot_basic",
    "markdown/tables.djot",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/x-djot", "text/djot"))
  assert_min_content_length(result, 10L)
})

test_that("office_doc_legacy", {
  skip_if_feature_unavailable("office")
  result <- run_fixture(
    "office_doc_legacy",
    "doc/unit_test_lists.doc",
    NULL,
    requirements = c("office"),
    notes = "Requires the office feature.",
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/msword"))
  assert_min_content_length(result, 20L)
})

test_that("office_docbook_basic", {
  result <- run_fixture(
    "office_docbook_basic",
    "docbook/docbook-reader.docbook",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/docbook+xml", "text/docbook"))
  assert_min_content_length(result, 10L)
})

test_that("office_docx_basic", {
  result <- run_fixture(
    "office_docx_basic",
    "docx/sample_document.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 10L)
})

test_that("office_docx_equations", {
  result <- run_fixture(
    "office_docx_equations",
    "docx/equations.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 20L)
})

test_that("office_docx_fake", {
  result <- run_fixture(
    "office_docx_fake",
    "docx/fake.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 20L)
})

test_that("office_docx_formatting", {
  result <- run_fixture(
    "office_docx_formatting",
    "docx/unit_test_formatting.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 20L)
})

test_that("office_docx_headers", {
  result <- run_fixture(
    "office_docx_headers",
    "docx/unit_test_headers.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 20L)
})

test_that("office_docx_lists", {
  result <- run_fixture(
    "office_docx_lists",
    "docx/unit_test_lists.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 20L)
})

test_that("office_docx_tables", {
  result <- run_fixture(
    "office_docx_tables",
    "docx/docx_tables.docx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.wordprocessingml.document"))
  assert_min_content_length(result, 50L)
  assert_content_contains_all(result, c("Simple uniform table", "Nested Table", "merged cells", "Header Col"))
  assert_table_count(result, minimum = 1L, maximum = NULL)
})

test_that("office_epub_basic", {
  result <- run_fixture(
    "office_epub_basic",
    "epub/features.epub",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/epub+zip"))
  assert_min_content_length(result, 50L)
})

test_that("office_fb2_basic", {
  result <- run_fixture(
    "office_fb2_basic",
    "fictionbook/basic.fb2",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-fictionbook+xml"))
  assert_min_content_length(result, 10L)
})

test_that("office_fictionbook_basic", {
  result <- run_fixture(
    "office_fictionbook_basic",
    "fictionbook/basic.fb2",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-fictionbook+xml", "application/x-fictionbook"))
  assert_min_content_length(result, 10L)
})

test_that("office_jats_basic", {
  result <- run_fixture(
    "office_jats_basic",
    "jats/sample_article.jats",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-jats+xml", "text/jats"))
  assert_min_content_length(result, 10L)
})

test_that("office_jupyter_basic", {
  result <- run_fixture(
    "office_jupyter_basic",
    "jupyter/rank.ipynb",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-ipynb+json"))
  assert_min_content_length(result, 10L)
})

test_that("office_latex_basic", {
  result <- run_fixture(
    "office_latex_basic",
    "latex/basic_sections.tex",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-latex", "text/x-latex"))
  assert_min_content_length(result, 20L)
})

test_that("office_markdown_basic", {
  result <- run_fixture(
    "office_markdown_basic",
    "markdown/comprehensive.md",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/markdown"))
  assert_min_content_length(result, 10L)
})

test_that("office_mdx_basic", {
  result <- run_fixture(
    "office_mdx_basic",
    "markdown/sample.mdx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/mdx", "text/x-mdx"))
  assert_min_content_length(result, 50L)
})

test_that("office_mdx_getting_started", {
  result <- run_fixture(
    "office_mdx_getting_started",
    "markdown/mdx_getting_started.mdx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/mdx", "text/x-mdx"))
  assert_min_content_length(result, 2000L)
})

test_that("office_mdx_troubleshooting", {
  result <- run_fixture(
    "office_mdx_troubleshooting",
    "markdown/mdx_troubleshooting.mdx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/mdx", "text/x-mdx"))
  assert_min_content_length(result, 2000L)
})

test_that("office_mdx_using_mdx", {
  result <- run_fixture(
    "office_mdx_using_mdx",
    "markdown/mdx_using_mdx.mdx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/mdx", "text/x-mdx"))
  assert_min_content_length(result, 2000L)
})

test_that("office_ods_basic", {
  result <- run_fixture(
    "office_ods_basic",
    "data_formats/test_01.ods",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.oasis.opendocument.spreadsheet"))
  assert_min_content_length(result, 10L)
})

test_that("office_odt_bold", {
  result <- run_fixture(
    "office_odt_bold",
    "odt/bold.odt",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.oasis.opendocument.text"))
  assert_min_content_length(result, 10L)
})

test_that("office_odt_list", {
  result <- run_fixture(
    "office_odt_list",
    "odt/unorderedList.odt",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.oasis.opendocument.text"))
  assert_min_content_length(result, 30L)
  assert_content_contains_any(result, c("list item", "New level", "Pushed us"))
})

test_that("office_odt_simple", {
  result <- run_fixture(
    "office_odt_simple",
    "odt/simple.odt",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.oasis.opendocument.text"))
  assert_min_content_length(result, 50L)
  assert_content_contains_any(result, c("favorite things", "Parrots", "Analysis"))
})

test_that("office_odt_table", {
  result <- run_fixture(
    "office_odt_table",
    "odt/table.odt",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.oasis.opendocument.text"))
  assert_min_content_length(result, 10L)
  assert_table_count(result, minimum = 1L, maximum = NULL)
})

test_that("office_opml_basic", {
  result <- run_fixture(
    "office_opml_basic",
    "opml/outline.opml",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/xml+opml", "text/x-opml", "application/x-opml+xml"))
  assert_min_content_length(result, 10L)
})

test_that("office_org_basic", {
  result <- run_fixture(
    "office_org_basic",
    "org/comprehensive.org",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/x-org", "text/org"))
  assert_min_content_length(result, 20L)
})

test_that("office_ppsx_slideshow", {
  result <- run_fixture(
    "office_ppsx_slideshow",
    "pptx/sample.ppsx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.presentationml.slideshow"))
  assert_min_content_length(result, 10L)
})

test_that("office_ppt_legacy", {
  skip_if_feature_unavailable("office")
  result <- run_fixture(
    "office_ppt_legacy",
    "ppt/simple.ppt",
    NULL,
    requirements = c("office"),
    notes = "Requires the office feature.",
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.ms-powerpoint"))
  assert_min_content_length(result, 10L)
})

test_that("office_pptx_basic", {
  result <- run_fixture(
    "office_pptx_basic",
    "pptx/simple.pptx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.presentationml.presentation"))
  assert_min_content_length(result, 50L)
})

test_that("office_pptx_images", {
  result <- run_fixture(
    "office_pptx_images",
    "pptx/powerpoint_with_image.pptx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.presentationml.presentation"))
  assert_min_content_length(result, 20L)
})

test_that("office_pptx_pitch_deck", {
  result <- run_fixture(
    "office_pptx_pitch_deck",
    "pptx/pitch_deck_presentation.pptx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.presentationml.presentation"))
  assert_min_content_length(result, 100L)
})

test_that("office_rst_basic", {
  result <- run_fixture(
    "office_rst_basic",
    "rst/restructured_text.rst",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("text/x-rst", "text/prs.fallenstein.rst"))
  assert_min_content_length(result, 20L)
})

test_that("office_rtf_basic", {
  result <- run_fixture(
    "office_rtf_basic",
    "rtf/extraction_test.rtf",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/rtf", "text/rtf"))
  assert_min_content_length(result, 10L)
})

test_that("office_typst_basic", {
  result <- run_fixture(
    "office_typst_basic",
    "typst/headings.typ",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/x-typst", "text/x-typst"))
  assert_min_content_length(result, 10L)
})

test_that("office_xls_legacy", {
  result <- run_fixture(
    "office_xls_legacy",
    "xls/test_excel.xls",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.ms-excel"))
  assert_min_content_length(result, 10L)
})

test_that("office_xlsx_basic", {
  result <- run_fixture(
    "office_xlsx_basic",
    "xlsx/stanley_cups.xlsx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"))
  assert_min_content_length(result, 100L)
  assert_content_contains_all(result, c("Team", "Location", "Stanley Cups"))
  assert_table_count(result, minimum = 1L, maximum = NULL)
  assert_metadata_expectation(result, "sheet_count", list(gte = 2L))
  assert_metadata_expectation(result, "sheet_names", list(contains = c("Stanley Cups")))
})

test_that("office_xlsx_multi_sheet", {
  result <- run_fixture(
    "office_xlsx_multi_sheet",
    "xlsx/excel_multi_sheet.xlsx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"))
  assert_min_content_length(result, 20L)
  assert_metadata_expectation(result, "sheet_count", list(gte = 2L))
})

test_that("office_xlsx_office_example", {
  result <- run_fixture(
    "office_xlsx_office_example",
    "xlsx/test_01.xlsx",
    NULL,
    requirements = character(0),
    notes = NULL,
    skip_if_missing = TRUE
  )
  assert_expected_mime(result, c("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"))
  assert_min_content_length(result, 10L)
})
# nolint end
