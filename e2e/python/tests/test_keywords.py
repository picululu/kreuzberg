# Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
# To regenerate: cargo run -p kreuzberg-e2e-generator -- generate --lang python
#
# Tests for keywords fixtures.
from __future__ import annotations

import pytest

from kreuzberg import (
    extract_file_sync,
)

from . import helpers


def test_keywords_rake() -> None:
    """Tests keyword extraction using RAKE algorithm"""

    document_path = helpers.resolve_document("pdf/fake_memo.pdf")
    if not document_path.exists():
        pytest.skip(f"Skipping keywords_rake: missing document at {document_path}")

    config = helpers.build_config({"keywords": {"algorithm": "rake", "max_keywords": 10}})

    result = extract_file_sync(document_path, None, config)

    helpers.assert_expected_mime(result, ["application/pdf"])
    helpers.assert_min_content_length(result, 10)
    helpers.assert_keywords(result, has_keywords=True, min_count=1, max_count=10)


def test_keywords_yake() -> None:
    """Tests keyword extraction using YAKE algorithm"""

    document_path = helpers.resolve_document("pdf/fake_memo.pdf")
    if not document_path.exists():
        pytest.skip(f"Skipping keywords_yake: missing document at {document_path}")

    config = helpers.build_config({"keywords": {"algorithm": "yake", "max_keywords": 10}})

    result = extract_file_sync(document_path, None, config)

    helpers.assert_expected_mime(result, ["application/pdf"])
    helpers.assert_min_content_length(result, 10)
    helpers.assert_keywords(result, has_keywords=True, min_count=1, max_count=10)
