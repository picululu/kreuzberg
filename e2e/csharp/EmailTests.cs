// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Email {
    public class EmailTests
    {
        [SkippableFact]
        public void EmailEmlHtmlBody()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("email/html_only.eml");
            TestHelpers.SkipIfOfficeTestOnWindows("email/html_only.eml");
            var documentPath = TestHelpers.EnsureDocument("email/html_only.eml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "message/rfc822" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void EmailEmlMultipart()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("email/html_email_multipart.eml");
            TestHelpers.SkipIfOfficeTestOnWindows("email/html_email_multipart.eml");
            var documentPath = TestHelpers.EnsureDocument("email/html_email_multipart.eml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "message/rfc822" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void EmailEmlUtf16()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("vendored/unstructured/eml/fake-email-utf-16.eml");
            TestHelpers.SkipIfOfficeTestOnWindows("vendored/unstructured/eml/fake-email-utf-16.eml");
            var documentPath = TestHelpers.EnsureDocument("vendored/unstructured/eml/fake-email-utf-16.eml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "message/rfc822" });
            TestHelpers.AssertMinContentLength(result, 50);
            TestHelpers.AssertContentContainsAny(result, new[] { "Test Email", "Roses are red" });
        }

        [SkippableFact]
        public void EmailMsgBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("email/fake_email.msg");
            TestHelpers.SkipIfOfficeTestOnWindows("email/fake_email.msg");
            var documentPath = TestHelpers.EnsureDocument("email/fake_email.msg", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.ms-outlook" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void EmailSampleEml()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("email/sample_email.eml");
            TestHelpers.SkipIfOfficeTestOnWindows("email/sample_email.eml");
            var documentPath = TestHelpers.EnsureDocument("email/sample_email.eml", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "message/rfc822" });
            TestHelpers.AssertMinContentLength(result, 20);
        }

    }
}
