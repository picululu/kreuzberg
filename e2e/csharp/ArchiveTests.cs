// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Archive {
    public class ArchiveTests
    {
        [SkippableFact]
        public void ArchiveSevenzBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("archives/documents.7z");
            TestHelpers.SkipIfOfficeTestOnWindows("archives/documents.7z");
            var documentPath = TestHelpers.EnsureDocument("archives/documents.7z", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/x-7z-compressed" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void ArchiveTarBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("archives/documents.tar");
            TestHelpers.SkipIfOfficeTestOnWindows("archives/documents.tar");
            var documentPath = TestHelpers.EnsureDocument("archives/documents.tar", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/x-tar", "application/tar" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void ArchiveZipBasic()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("archives/documents.zip");
            TestHelpers.SkipIfOfficeTestOnWindows("archives/documents.zip");
            var documentPath = TestHelpers.EnsureDocument("archives/documents.zip", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/zip", "application/x-zip-compressed" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

    }
}
