// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Contract
{
    public class ContractTests
    {
        [SkippableFact]
        public async Task ApiBatchBytesAsync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var fileBytes = await File.ReadAllBytesAsync(documentPath);
            var mimeType = KreuzbergClient.DetectMimeType(fileBytes);
            var results = await KreuzbergClient.BatchExtractBytesAsync(new[] { new BytesWithMime(fileBytes, mimeType) }, config);
            var result = results[0];
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public void ApiBatchBytesSync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var fileBytes = File.ReadAllBytes(documentPath);
            var mimeType = KreuzbergClient.DetectMimeType(fileBytes);
            var results = KreuzbergClient.BatchExtractBytesSync(new[] { new BytesWithMime(fileBytes, mimeType) }, config);
            var result = results[0];
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public async Task ApiBatchFileAsync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var results = await KreuzbergClient.BatchExtractFilesAsync(new[] { documentPath }, config);
            var result = results[0];
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public void ApiBatchFileSync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var results = KreuzbergClient.BatchExtractFilesSync(new[] { documentPath }, config);
            var result = results[0];
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public async Task ApiExtractBytesAsync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var fileBytes = await File.ReadAllBytesAsync(documentPath);
            var mimeType = KreuzbergClient.DetectMimeType(fileBytes);
            var result = await KreuzbergClient.ExtractBytesAsync(fileBytes, mimeType, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public void ApiExtractBytesSync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var fileBytes = File.ReadAllBytes(documentPath);
            var mimeType = KreuzbergClient.DetectMimeType(fileBytes);
            var result = KreuzbergClient.ExtractBytesSync(fileBytes, mimeType, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public async Task ApiExtractFileAsync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var result = await KreuzbergClient.ExtractFileAsync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public void ApiExtractFileSync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentContainsAny(result, new[] { "May 5, 2023", "Mallori" });
        }

        [SkippableFact]
        public void ConfigChunking()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"chunking\":{\"max_chars\":500,\"max_overlap\":50}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertChunks(result, 1, null, true, null);
        }

        [SkippableFact]
        public void ConfigDocumentStructure()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"include_document_structure\":true}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertDocument(result, true, 1, new[] { "paragraph" }, null);
        }

        [SkippableFact]
        public void ConfigDocumentStructureDisabled()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig(null);

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertDocument(result, false, null, null, null);
        }

        [SkippableFact]
        public void ConfigDocumentStructureWithHeadings()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("docx/fake.docx");
            TestHelpers.SkipIfOfficeTestOnWindows("docx/fake.docx");
            var documentPath = TestHelpers.EnsureDocument("docx/fake.docx", true);
            var config = TestHelpers.BuildConfig("{\"include_document_structure\":true}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/vnd.openxmlformats-officedocument.wordprocessingml.document" });
            TestHelpers.AssertDocument(result, true, 1, null, null);
        }

        [SkippableFact]
        public void ConfigForceOcr()
        {
            TestHelpers.SkipIfFeatureUnavailable("tesseract");
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"force_ocr\":true}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 5);
        }

        [SkippableFact]
        public void ConfigHtmlOptions()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("html/complex_table.html");
            TestHelpers.SkipIfOfficeTestOnWindows("html/complex_table.html");
            var documentPath = TestHelpers.EnsureDocument("html/complex_table.html", true);
            var config = TestHelpers.BuildConfig("{\"html_options\":{\"include_links\":true}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "text/html" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentNotEmpty(result);
        }

        [SkippableFact]
        public void ConfigImages()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/embedded_images_tables.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/embedded_images_tables.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/embedded_images_tables.pdf", true);
            var config = TestHelpers.BuildConfig("{\"images\":{\"extract_images\":true}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertImages(result, 1, null, null);
        }

        [SkippableFact]
        public void ConfigKeywords()
        {
            TestHelpers.SkipIfFeatureUnavailable("keywords-yake");
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"keywords\":{\"algorithm\":\"yake\",\"max_keywords\":10}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertKeywords(result, true, 1, null);
        }

        [SkippableFact]
        public void ConfigLanguageDetection()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"language_detection\":{\"enabled\":true}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertDetectedLanguages(result, new[] { "eng" }, 0.5);
        }

        [SkippableFact]
        public void ConfigPages()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/multi_page.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/multi_page.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/multi_page.pdf", true);
            var config = TestHelpers.BuildConfig("{\"pages\":{\"end\":3,\"start\":1}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void ConfigQualityDisabled()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"enable_quality_processing\":false}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertContentNotEmpty(result);
        }

        [SkippableFact]
        public void ConfigUseCacheFalse()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"use_cache\":false}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void OutputFormatBytesMarkdown()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"output_format\":\"markdown\"}");

            var fileBytes = File.ReadAllBytes(documentPath);
            var mimeType = KreuzbergClient.DetectMimeType(fileBytes);
            var result = KreuzbergClient.ExtractBytesSync(fileBytes, mimeType, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void OutputFormatDjot()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"output_format\":\"djot\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void OutputFormatHtml()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"output_format\":\"html\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void OutputFormatMarkdown()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"output_format\":\"markdown\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void OutputFormatPlain()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"output_format\":\"plain\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

        [SkippableFact]
        public void ResultFormatElementBased()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"result_format\":\"element_based\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertElements(result, 1, null);
        }

        [SkippableFact]
        public void ResultFormatUnified()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"result_format\":\"unified\"}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
        }

    }
}
