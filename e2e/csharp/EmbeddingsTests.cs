// Code generated by kreuzberg-e2e-generator. DO NOT EDIT.
using System;
using System.Collections.Generic;
using System.IO;
using System.Threading.Tasks;
using Kreuzberg;
using Xunit;
using Kreuzberg.E2E;

namespace Kreuzberg.E2E.Embeddings
{
    public class EmbeddingsTests
    {
        [SkippableFact]
        public async Task EmbeddingAsync()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"chunking\":{\"embedding\":{\"model\":{\"preset\":\"balanced\"},\"normalize\":true},\"max_chars\":500,\"max_overlap\":50}}");

            var result = await KreuzbergClient.ExtractFileAsync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertChunks(result, 1, null, true, true);
        }

        [SkippableFact]
        public void EmbeddingBalancedPreset()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"chunking\":{\"embedding\":{\"model\":{\"preset\":\"balanced\"},\"normalize\":true},\"max_chars\":500,\"max_overlap\":50}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertChunks(result, 1, null, true, true);
        }

        [SkippableFact]
        public void EmbeddingDisabled()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"chunking\":{\"max_chars\":500,\"max_overlap\":50}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertChunks(result, 1, null, true, false);
        }

        [SkippableFact]
        public void EmbeddingFastPreset()
        {
            TestHelpers.SkipIfLegacyOfficeDisabled("pdf/fake_memo.pdf");
            TestHelpers.SkipIfOfficeTestOnWindows("pdf/fake_memo.pdf");
            var documentPath = TestHelpers.EnsureDocument("pdf/fake_memo.pdf", true);
            var config = TestHelpers.BuildConfig("{\"chunking\":{\"embedding\":{\"model\":{\"preset\":\"fast\"},\"normalize\":true},\"max_chars\":500,\"max_overlap\":50}}");

            var result = KreuzbergClient.ExtractFileSync(documentPath, config);
            TestHelpers.AssertExpectedMime(result, new[] { "application/pdf" });
            TestHelpers.AssertMinContentLength(result, 10);
            TestHelpers.AssertChunks(result, 1, null, true, true);
        }

    }
}
